<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Products</title>
    <link rel="stylesheet" href="food.css">
    <link href="https://fonts.googleapis.com/css2?family=Bree+Serif&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>

    <nav id="navbar">
        <div id="logo">
            <img src="logo.jpg" alt="CampusEats">
        </div>

        <ul>
            <li class="item"><a href="firstpage1.html">Home</a></li>
            <li class="item"><a href="category1.html">Menu</a></li>
            <li class="item"><a href="food.html">Today's Specials</a></li>
            <li class="item"><a href="profile.html">My Profile</a></li>
        </ul>
    </nav>

    <div class="cart-icon">
        <a href="cart.html" class="fas fa-shopping-cart"></a>
    </div>

</section>
    
<section class="products" id="products">
    <h1 class="heading">DBIT <span>Canteen Menu</span></h1>
    <div class="box-container">

        
        <div class="box">
            <span class="discount">-10%</span>
            <div class="image">
                <img src="Paneer Kathi Rolls Recipe - khaddoroshik.jfif" alt="idli sambar">
                <div class="icons">
                    
                    <a href="#" class="cart-btn fas fa-shopping-cart"> </a>
                   
                </div>
            </div>
            <div class="content">
                <h3> Paneer roll</h3>
                <div class="price">₹35</div>
            </div>
        </div>

        
        
        <div class="box">
            <span class="discount">-5%</span>
            <div class="image">
                <img src="Pav Bhaji Recipe (Mumbai Street-style) - Cooking Carnival.jfif" alt="Burger with Cheese">
                <div class="icons">
                    
                    <a href="#" class="cart-btn fas fa-shopping-cart"></a>
                   
                </div>
            </div>
            <div class="content">
                <h3>Pav Bhaji</h3>
                <div class="price">₹60</div>
            </div>
        </div>

        
        <div class="box">
            <span class="discount">-8%</span>
            <div class="image">
                <img src="Crispy Masala Dosa.jfif" alt="Burger with Cheese">
                <div class="icons">
                    
                    <a href="#" class="cart-btn fas fa-shopping-cart"></a>
                   
                </div>
            </div>
            <div class="content">
                <h3>Masala Dosa</h3>
                <div class="price">₹80</div>
            </div>
        </div>

        
        <div class="box">
            <span class="discount">-15%</span>
            <div class="image">
                <img src="Authentic Butter Chicken (Murgh Makhani) - Masala and Chai.jfif" alt="Burger with Cheese">
                <div class="icons">
                    
                    <a href="#" class="cart-btn fas fa-shopping-cart"></a>
                   
                </div>
            </div>
            <div class="content">
                <h3>Butter Chicken</h3>
                <div class="price">₹150</div>
            </div>
        </div>

        
        <div class="box">
            <span class="discount">-10%</span>
            <div class="image">
                <img src="idli-sambar-vada-coconut-chutney-south-indian-breakfast_57665-7256.avif" alt="Burger with Cheese">
                <div class="icons">
                    
                    <a href="#" class="cart-btn fas fa-shopping-cart"></a>
                   
                </div>
            </div>
            <div class="content">
                <h3>Idli sambar</h3>
                <div class="price">₹110</div>
            </div>
        </div>

        
        <div class="box">
            <span class="discount">-10%</span>
            <div class="image">
                <img src="food2.jfif" alt="Noodle Frankie">
                <div class="icons">
                    
                    <a href="#" class="cart-btn fas fa-shopping-cart"></a>
                   
                </div>
            </div>
            <div class="content">
                <h3>Noodle frankie</h3>
                <div class="price">₹50</div>
            </div>
        </div>
       
        
        <div class="box">
            <span class="discount">-10%</span>
            <div class="image">
                <img src="food3.jfif" alt="Veg Frankie">
                <div class="icons">
                    
                    <a href="#" class="cart-btn fas fa-shopping-cart"></a>
                   
                </div>
            </div>
            <div class="content">
                <h3>Snack</h3>
                <div class="price">₹50</div>
            </div>
        </div>

        
        <div class="box">
            <span class="discount">-10%</span>
            <div class="image">
                <img src="food5.jfif" alt="Veg Frankie">
                <div class="icons">
                    
                    <a href="#" class="cart-btn fas fa-shopping-cart"></a>
                   
                </div>
            </div>
            <div class="content">
                <h3>Sweet</h3>
                <div class="price">₹55</div>
            </div>
        </div>
        
        
        <div class="box">
            <span class="discount">-10%</span>
            <div class="image">
                <img src="food4.jfif" alt="Egg Frankie">
                <div class="icons">
                    
                    <a href="#" class="cart-btn fas fa-shopping-cart"></a>
                   
                </div>
            </div>
            <div class="content">
                <h3>Tea</h3>
                <div class="price">₹10</div>
            </div>
        </div>
        
        
        <div class="box">
            <span class="discount">-10%</span>
            <div class="image">
                <img src="6 Classic North Indian Veg Lunch Recipes That Rule Our Heart.jfif" alt="Egg Frankie">
                <div class="icons">
                    
                    <a href="#" class="cart-btn fas fa-shopping-cart"></a>
                   
                </div>
            </div>
            <div class="content">
                <h3>Rajma</h3>
                <div class="price">₹45</div>
            </div>
        </div>
        
        
        <div class="box">
            <span class="discount">-10%</span>
            <div class="image">
                <img src="Lunch.jfif" alt="Egg Frankie">
                <div class="icons">
                    
                    <a href="" class="cart-btn fas fa-shopping-cart"></a>
                   
                </div>
            </div>
            <div class="content">
                <h3>Dal rice</h3>
                <div class="price">₹50</div>
            </div>
        </div>
        
        
        <div class="box">
            <span class="discount">-10%</span>
            <div class="image">
                <img src="download.jfif" alt="Egg Frankie">
                <div class="icons">
                    
                    <a href="#" class="cart-btn fas fa-shopping-cart"></a>
                   
                </div>
            </div>
            <div class="content">
                <h3>Sada Dosa</h3>
                <div class="price">₹50</div>
            </div>
        </div>

        
        
    </div>
</section>

    <!-- Admin Panel (Visible only to admin users) -->
    <section id="admin-panel" style="display:none;">
        <h2>Add New Food Item</h2>
        <form id="addFoodForm">
            <label for="foodName">Food Name</label>
            <input type="text" id="foodName" placeholder="Enter food name" required>

            <label for="foodPrice">Price (₹)</label>
            <input type="number" id="foodPrice" placeholder="Enter food price" required>

            <label for="foodImage">Upload Image</label>
            <input type="file" id="foodImage" accept="image/*" required>

            <button type="submit" class="btn">Save Changes</button>
            <button type="reset" class="btn">Reset</button>
        </form>
    </section>

    <script>
        
        document.addEventListener('DOMContentLoaded', () => {
        const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));

        // Show admin panel if the admin is logged in
        if (loggedInUser && loggedInUser.username === 'admin@dbit') {
            document.getElementById('admin-panel').style.display = 'block';
        }

        // Handle adding new food items
        const foodForm = document.getElementById('addFoodForm');
        foodForm.addEventListener('submit', function(event) {
            event.preventDefault();
            
            const foodName = document.getElementById('foodName').value;
            const foodPrice = document.getElementById('foodPrice').value;
            const foodImage = document.getElementById('foodImage').files[0];
            
            if (foodImage) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageUrl = e.target.result;

                    // Create new food item object
                    const newItem = {
                        id: Date.now(),  // Add a unique ID for deletion
                        name: foodName,
                        price: foodPrice,
                        image: imageUrl
                    };

                    // Save new item in localStorage
                    let menuItems = JSON.parse(localStorage.getItem('menuItems')) || [];
                    menuItems.push(newItem);
                    localStorage.setItem('menuItems', JSON.stringify(menuItems));

                    // Update the menu display
                    addFoodToMenu(newItem);

                    // Reset the form
                    foodForm.reset();
                };
                reader.readAsDataURL(foodImage);
            }
        });

        // Function to add new food items to the menu
        function addFoodToMenu(item) {
            const container = document.querySelector('.box-container');
            const newBox = document.createElement('div');
            newBox.classList.add('box');

            newBox.innerHTML = `
                <div class="image">
                    <img src="${item.image}" alt="${item.name}">
                    <div class="icons">
                        
                        <a href="#" class="cart-btn fas fa-shopping-cart"></a>
                       
                    </div>
                </div>
                <div class="content">
                    <h3>${item.name}</h3>
                    <div class="price">₹${item.price}</div>
                    <button class="delete-btn" data-id="${item.id}">Delete</button>
                </div>
            `;
            
            container.appendChild(newBox);

            // Add event listener to delete button
            newBox.querySelector('.delete-btn').addEventListener('click', () => {
                deleteMenuItem(item.id);
            });
        }

        // Load existing menu items from localStorage on page load
        const savedItems = JSON.parse(localStorage.getItem('menuItems')) || [];
        savedItems.forEach(item => addFoodToMenu(item));

        // Function to delete menu item --FOR ADMIN ONLY--
        function deleteMenuItem(id) {
            let menuItems = JSON.parse(localStorage.getItem('menuItems')) || [];
            menuItems = menuItems.filter(item => item.id !== id);
            localStorage.setItem('menuItems', JSON.stringify(menuItems));
            document.querySelector('.box-container').innerHTML = '';
            menuItems.forEach(item => addFoodToMenu(item));
        }

        // Add to cart functionality

        const buttons = document.getElementsByClassName("fas fa-shopping-cart");

        function addToCart(item, price) {
                const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));

                if(!loggedInUser){
                    alert("Kindly Login first!");
                    window.location.href = 'login1.html';
                }
            else{
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            let itemExists = cart.find(cartItem => cartItem.name === item);
            if (itemExists) {
                itemExists.quantity += 1;
            } else {
                cart.push({ name: item, price: price, quantity: 1 });
            }
            localStorage.setItem('cart', JSON.stringify(cart));
            alert(`${item} has been added to your cart!`);
        }
        }

        document.querySelectorAll('.cart-btn').forEach(button => {
            button.addEventListener('click', (event) => {
                const box = event.target.closest('.box');
                const itemName = box.querySelector('.content h3').innerText;
                const itemPrice = box.querySelector('.price').innerText.replace('₹', '');
                addToCart(itemName, itemPrice);
            });
        });

        // Cart functionality with delete feature
        const cartContainer = document.querySelector('.bg-[#f5f5dc] p-4 w-1/4');
        let cart = JSON.parse(localStorage.getItem('cart')) || [];

        function renderCartItems() {
            cartContainer.innerHTML = '';
            cart.forEach((item, index) => {
                const cartItemHTML = `
                    <div class="flex justify-between mb-2">
                        <p>${item.name}</p>
                        <p>₹${item.price} x ${item.quantity}</p>
                        <button class="remove-cart-item" data-index="${index}">Remove</button>
                    </div>
                `;
                cartContainer.innerHTML += cartItemHTML;
            });

            // Add event listeners to remove buttons
            document.querySelectorAll('.remove-cart-item').forEach(button => {
                button.addEventListener('click', (event) => {
                    const index = event.target.getAttribute('data-index');
                    deleteCartItem(index);
                });
            });
        }

        function deleteCartItem(index) {
            cart.splice(index, 1);
            localStorage.setItem('cart', JSON.stringify(cart));
            renderCartItems();
        }

        renderCartItems();

        document.addEventListener('storage', () => {
            cart = JSON.parse(localStorage.getItem('cart')) || [];
            renderCartItems();
        });

    });
   
    </script>
</body>
</html>


